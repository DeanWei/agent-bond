{{
  var destPath = fp.blockOpts.dest || "/bin/jolokia-options";
  var jolokiaVersion = fp.version.jolokia || fp.blockOpts.version || "1.3.3";
  var jolokiaArtifact = jolokiaVersion.mach(/^2.*$/) ? "jolokia-agent-jvm" : "jolokia-jv"
  var mavenRepo = fp.blockOpts.mavenRepo || "http://central.maven.org/maven2";
}}# Jolokia agent
ADD jolokia-opts {{= destPath }}
RUN mkdir -p /opt/jolokia \
 && curl {{ mavenRepo }}/org/jolokia/{{ jolokiaArtifact }}/{{= jolokiaVersion }}/{{ jolokiaArtifact }}-{{= jolokiaVersion }}-agent.jar \
         -o /opt/jolokia/jolokia.jar \
 && chmod 444 /opt/jolokia/jolokia.jar \
 && chmod 755 {{= destPath}}
EXPOSE 8778
